{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.3", "generated_at": "2026-01-20T21:31:34.514874Z", "invocation_id": "c9a95c3d-8445-4111-b9c5-9c94afff878e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.149580Z", "completed_at": "2026-01-20T21:31:34.162155Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.164856Z", "completed_at": "2026-01-20T21:31:34.164856Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019226789474487305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.medical_warehouse.stg_image_detections", "compiled": true, "compiled_code": "/*\n    Staging Model: stg_image_detections\n    Purpose: Cleans and standardizes raw YOLOv8 image detection data.\n    Grain: One row per detected object (message_id + detected_class + confidence_score).\n*/\n\nwith source as (\n    select * from \"medical_warehouse\".\"raw\".\"image_detections\"\n),\n\ncleaned as (\n    select\n        -- IDs (normalize join key)\n        message_id::int as message_id,\n        \n        -- Detection attributes\n        detected_class::varchar as detected_class,\n        confidence_score::numeric as confidence_score,\n        \n        -- Metadata\n        loaded_at::timestamp as loaded_at\n    \n    from source\n    \n    -- Filter out invalid records\n    where message_id is not null\n      and detected_class is not null\n      and confidence_score is not null\n)\n\nselect\n    message_id,\n    detected_class,\n    confidence_score,\n    loaded_at,\n    \n    -- Derived columns for quality filtering\n    case\n        when confidence_score >= 0.5 then 'high'\n        when confidence_score >= 0.3 then 'medium'\n        else 'low'\n    end as confidence_level\n\nfrom cleaned", "relation_name": "\"medical_warehouse\".\"analytics\".\"stg_image_detections\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.156964Z", "completed_at": "2026-01-20T21:31:34.163795Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.167228Z", "completed_at": "2026-01-20T21:31:34.167228Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0208895206451416, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.medical_warehouse.stg_telegram_messages", "compiled": true, "compiled_code": "/*\n    Staging Model: stg_telegram_messages\n    Purpose: Cleans and standardizes raw telegram message data.\n    Grain: One row per message.\n*/\n\nwith source as (\n    select * from \"medical_warehouse\".\"raw\".\"telegram_messages\"\n),\n\nrenamed as (\n    select\n        -- IDs\n        id as message_id,\n        \n        -- Dimensions\n        channel_name,\n        message_text,\n        image_path,\n        \n        -- Timestamps\n        message_date::timestamp AT TIME ZONE 'UTC' as message_date,\n        \n        -- Metrics\n        views::int as views,\n        forwards::int as forwards,\n\n        -- Preserve raw payload\n        to_jsonb(source) as raw_payload\n\n    from source\n)\n\nselect\n    message_id,\n    channel_name,\n    message_date,\n    message_text,\n    views,\n    forwards,\n    image_path,\n\n    -- Derived columns\n    length(message_text) as message_length,\n    case \n        when image_path is not null then true \n        else false \n    end as has_image,\n\n    raw_payload\n\nfrom renamed\n\n\nwhere message_text is not null and message_text != ''\n", "relation_name": "\"medical_warehouse\".\"analytics\".\"stg_telegram_messages\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.178913Z", "completed_at": "2026-01-20T21:31:34.193661Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.197995Z", "completed_at": "2026-01-20T21:31:34.197995Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.030545473098754883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.medical_warehouse.dim_channels", "compiled": true, "compiled_code": "/*\n    Mart Model: dim_channels\n    Purpose: Dimension table for derived channel attributes.\n    Grain: One row per channel.\n*/\n\nwith stg as (\n    select * from \"medical_warehouse\".\"analytics\".\"stg_telegram_messages\"\n),\n\nchannel_stats as (\n    select\n        channel_name,\n        min(message_date) as first_post_date,\n        max(message_date) as last_post_date,\n        count(*) as total_posts,\n        avg(views) as avg_views\n    from stg\n    group by 1\n)\n\nselect\n    -- Surrogate Key - UPDATED to use generate_surrogate_key\n    md5(cast(coalesce(cast(channel_name as TEXT), '') as TEXT)) as channel_key,\n    \n    channel_name,\n    \n    -- Assuming title is same as name if not distinct in source, or map from another source if avail. \n    -- Requirement says: \"channel_title (use channel_name if none)\"\n    channel_name as channel_title,\n    \n    -- Placeholder logic for channel_type\n    case \n        when channel_name ilike '%news%' then 'News'\n        when channel_name ilike '%chart%' then 'Data'\n        else 'General'\n    end as channel_type,\n    \n    first_post_date,\n    last_post_date,\n    total_posts,\n    avg_views\n\nfrom channel_stats", "relation_name": "\"medical_warehouse\".\"analytics\".\"dim_channels\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.184034Z", "completed_at": "2026-01-20T21:31:34.195945Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.200297Z", "completed_at": "2026-01-20T21:31:34.200297Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.030695438385009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.medical_warehouse.dim_dates", "compiled": true, "compiled_code": "/*\n    Mart Model: dim_dates\n    Purpose: Date dimension table to support time-based analysis.\n    Grain: One row per day.\n*/\n\nwith stg_dates as (\n    select distinct \n        date(message_date) as full_date\n    from \"medical_warehouse\".\"analytics\".\"stg_telegram_messages\"\n    where message_date is not null\n),\n\ndate_details as (\n    select\n        full_date,\n        cast(to_char(full_date, 'YYYYMMDD') as int) as date_key,\n        extract(dow from full_date) as day_of_week,\n        to_char(full_date, 'Day') as day_name,\n        extract(week from full_date) as week_of_year,\n        extract(month from full_date) as month,\n        to_char(full_date, 'Month') as month_name,\n        extract(quarter from full_date) as quarter,\n        extract(year from full_date) as year\n    from stg_dates\n)\n\nselect\n    date_key,\n    full_date,\n    day_of_week,\n    day_name,\n    week_of_year,\n    month,\n    month_name,\n    quarter,\n    year,\n    case \n        when day_of_week in (0, 6) then true -- 0 is Sunday, 6 is Saturday in Postgres (usually, check specific DB settings)\n        else false \n    end as is_weekend\nfrom date_details", "relation_name": "\"medical_warehouse\".\"analytics\".\"dim_dates\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.190272Z", "completed_at": "2026-01-20T21:31:34.197995Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.205220Z", "completed_at": "2026-01-20T21:31:34.205220Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03420138359069824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.assert_non_negative_views", "compiled": true, "compiled_code": "-- Custom test: assert_non_negative_views\n-- Returns rows where view count is less than 0, which should be impossible.\n\nselect *\nfrom \"medical_warehouse\".\"analytics\".\"stg_telegram_messages\"\nwhere views < 0", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.187580Z", "completed_at": "2026-01-20T21:31:34.199554Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.206838Z", "completed_at": "2026-01-20T21:31:34.206838Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03850960731506348, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.assert_no_future_messages", "compiled": true, "compiled_code": "-- Custom test: assert_no_future_messages\n-- Returns rows where message_date is in the future relative to the current timestamp.\n\nselect *\nfrom \"medical_warehouse\".\"analytics\".\"stg_telegram_messages\"\nwhere message_date > now()", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.216905Z", "completed_at": "2026-01-20T21:31:34.242662Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.252061Z", "completed_at": "2026-01-20T21:31:34.252061Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04516458511352539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect message_date\nfrom \"medical_warehouse\".\"analytics\".\"stg_telegram_messages\"\nwhere message_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.229042Z", "completed_at": "2026-01-20T21:31:34.248500Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.255106Z", "completed_at": "2026-01-20T21:31:34.255106Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.045896053314208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect message_id\nfrom \"medical_warehouse\".\"analytics\".\"stg_telegram_messages\"\nwhere message_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.237979Z", "completed_at": "2026-01-20T21:31:34.250526Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.257305Z", "completed_at": "2026-01-20T21:31:34.257305Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04590606689453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect channel_key\nfrom \"medical_warehouse\".\"analytics\".\"dim_channels\"\nwhere channel_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.244021Z", "completed_at": "2026-01-20T21:31:34.253588Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.260526Z", "completed_at": "2026-01-20T21:31:34.260526Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03863406181335449, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect channel_name\nfrom \"medical_warehouse\".\"analytics\".\"dim_channels\"\nwhere channel_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.271877Z", "completed_at": "2026-01-20T21:31:34.290017Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.300398Z", "completed_at": "2026-01-20T21:31:34.300398Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03962993621826172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    channel_key as unique_field,\n    count(*) as n_records\n\nfrom \"medical_warehouse\".\"analytics\".\"dim_channels\"\nwhere channel_key is not null\ngroup by channel_key\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.281060Z", "completed_at": "2026-01-20T21:31:34.297177Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.301984Z", "completed_at": "2026-01-20T21:31:34.301984Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03765988349914551, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    channel_name as unique_field,\n    count(*) as n_records\n\nfrom \"medical_warehouse\".\"analytics\".\"dim_channels\"\nwhere channel_name is not null\ngroup by channel_name\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.286563Z", "completed_at": "2026-01-20T21:31:34.298811Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.304693Z", "completed_at": "2026-01-20T21:31:34.304693Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03737521171569824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.medical_warehouse.fct_messages", "compiled": true, "compiled_code": "/*\n    Mart Model: fct_messages\n    Purpose: Fact table containing message metrics and keys to dimensions.\n    Grain: One row per message.\n*/\n\nwith stg as (\n    select * from \"medical_warehouse\".\"analytics\".\"stg_telegram_messages\"\n),\n\ndates as (\n    select * from \"medical_warehouse\".\"analytics\".\"dim_dates\"\n),\n\nchannels as (\n    select * from \"medical_warehouse\".\"analytics\".\"dim_channels\"\n)\n\nselect\n    stg.message_id,\n    \n    -- Foreign Keys\n    channels.channel_key,\n    dates.date_key,\n    \n    -- Metrics / Facts\n    stg.message_text,\n    stg.message_length,\n    stg.views as view_count,\n    stg.forwards as forward_count,\n    stg.has_image,\n    stg.image_path,\n    \n    -- Metadata\n    stg.message_date as created_at\n\nfrom stg\nleft join channels \n    on stg.channel_name = channels.channel_name\nleft join dates \n    on date(stg.message_date) = dates.full_date", "relation_name": "\"medical_warehouse\".\"analytics\".\"fct_messages\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.291241Z", "completed_at": "2026-01-20T21:31:34.308311Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.315790Z", "completed_at": "2026-01-20T21:31:34.315790Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04532170295715332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_key\nfrom \"medical_warehouse\".\"analytics\".\"dim_dates\"\nwhere date_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.319127Z", "completed_at": "2026-01-20T21:31:34.330844Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.339594Z", "completed_at": "2026-01-20T21:31:34.339594Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03389120101928711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_key as unique_field,\n    count(*) as n_records\n\nfrom \"medical_warehouse\".\"analytics\".\"dim_dates\"\nwhere date_key is not null\ngroup by date_key\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.326526Z", "completed_at": "2026-01-20T21:31:34.338280Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.343769Z", "completed_at": "2026-01-20T21:31:34.343769Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03722500801086426, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.medical_warehouse.fct_image_detections", "compiled": true, "compiled_code": "/*\n    Mart Model: fct_image_detections\n    Purpose: Fact table for YOLO image detections enriched with message context.\n    Grain: One row per detected object (message_id + detected_class + confidence_score).\n*/\n\nwith detections as (\n    select * from \"medical_warehouse\".\"analytics\".\"stg_image_detections\"\n),\n\nmessages as (\n    select * from \"medical_warehouse\".\"analytics\".\"fct_messages\"\n)\n\nselect\n    -- Primary identifiers\n    detections.message_id,\n    \n    -- Foreign Keys from messages\n    messages.channel_key,\n    messages.date_key,\n    \n    -- Detection attributes\n    detections.detected_class,\n    detections.confidence_score,\n    detections.confidence_level,\n    \n    -- Derived business category\n    case\n        when detections.detected_class = 'person' then 'promotional'\n        when detections.detected_class in ('bottle', 'pill', 'syringe', 'container') then 'product_display'\n        else 'other'\n    end as image_category,\n    \n    -- Optional: Include message metrics for contextualized analysis\n    messages.view_count,\n    messages.forward_count,\n    messages.created_at as message_date\n\nfrom detections\ninner join messages\n    on detections.message_id = messages.message_id", "relation_name": "\"medical_warehouse\".\"analytics\".\"fct_image_detections\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.331979Z", "completed_at": "2026-01-20T21:31:34.340968Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.352786Z", "completed_at": "2026-01-20T21:31:34.352786Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04107999801635742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect channel_key\nfrom \"medical_warehouse\".\"analytics\".\"fct_messages\"\nwhere channel_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.346003Z", "completed_at": "2026-01-20T21:31:34.354847Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.366208Z", "completed_at": "2026-01-20T21:31:34.366208Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029877185821533203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.not_null_fct_messages_date_key.6dec6e1bc3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_key\nfrom \"medical_warehouse\".\"analytics\".\"fct_messages\"\nwhere date_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.360706Z", "completed_at": "2026-01-20T21:31:34.374592Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.386652Z", "completed_at": "2026-01-20T21:31:34.386652Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.036624908447265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect message_id\nfrom \"medical_warehouse\".\"analytics\".\"fct_messages\"\nwhere message_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.369894Z", "completed_at": "2026-01-20T21:31:34.384942Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.391006Z", "completed_at": "2026-01-20T21:31:34.391006Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0405583381652832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select channel_key as from_field\n    from \"medical_warehouse\".\"analytics\".\"fct_messages\"\n    where channel_key is not null\n),\n\nparent as (\n    select channel_key as to_field\n    from \"medical_warehouse\".\"analytics\".\"dim_channels\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.378516Z", "completed_at": "2026-01-20T21:31:34.388984Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.400916Z", "completed_at": "2026-01-20T21:31:34.400916Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.037619829177856445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select date_key as from_field\n    from \"medical_warehouse\".\"analytics\".\"fct_messages\"\n    where date_key is not null\n),\n\nparent as (\n    select date_key as to_field\n    from \"medical_warehouse\".\"analytics\".\"dim_dates\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.392052Z", "completed_at": "2026-01-20T21:31:34.401930Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.407836Z", "completed_at": "2026-01-20T21:31:34.407836Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030675888061523438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    message_id as unique_field,\n    count(*) as n_records\n\nfrom \"medical_warehouse\".\"analytics\".\"fct_messages\"\nwhere message_id is not null\ngroup by message_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.409343Z", "completed_at": "2026-01-20T21:31:34.422119Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.432634Z", "completed_at": "2026-01-20T21:31:34.432634Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03174781799316406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.accepted_values_fct_image_detections_image_category__promotional__product_display__other.cc764fcd0d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        image_category as value_field,\n        count(*) as n_records\n\n    from \"medical_warehouse\".\"analytics\".\"fct_image_detections\"\n    group by image_category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'promotional','product_display','other'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.417308Z", "completed_at": "2026-01-20T21:31:34.430535Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.436280Z", "completed_at": "2026-01-20T21:31:34.436280Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03781747817993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.not_null_fct_image_detections_channel_key.0704f80fcb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect channel_key\nfrom \"medical_warehouse\".\"analytics\".\"fct_image_detections\"\nwhere channel_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.424152Z", "completed_at": "2026-01-20T21:31:34.433154Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.445113Z", "completed_at": "2026-01-20T21:31:34.445113Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03303670883178711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.not_null_fct_image_detections_confidence_score.4462a9960e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect confidence_score\nfrom \"medical_warehouse\".\"analytics\".\"fct_image_detections\"\nwhere confidence_score is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.437606Z", "completed_at": "2026-01-20T21:31:34.446133Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.452918Z", "completed_at": "2026-01-20T21:31:34.452918Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03102278709411621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.not_null_fct_image_detections_date_key.5029d983a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_key\nfrom \"medical_warehouse\".\"analytics\".\"fct_image_detections\"\nwhere date_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.453429Z", "completed_at": "2026-01-20T21:31:34.468903Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.477478Z", "completed_at": "2026-01-20T21:31:34.477478Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03346991539001465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.not_null_fct_image_detections_detected_class.bab256aee8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect detected_class\nfrom \"medical_warehouse\".\"analytics\".\"fct_image_detections\"\nwhere detected_class is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.463584Z", "completed_at": "2026-01-20T21:31:34.475400Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.483137Z", "completed_at": "2026-01-20T21:31:34.483137Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04041552543640137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.not_null_fct_image_detections_image_category.9885d32251", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect image_category\nfrom \"medical_warehouse\".\"analytics\".\"fct_image_detections\"\nwhere image_category is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.470457Z", "completed_at": "2026-01-20T21:31:34.478992Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.490192Z", "completed_at": "2026-01-20T21:31:34.490192Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03320026397705078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.not_null_fct_image_detections_message_id.fccdbca0c8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect message_id\nfrom \"medical_warehouse\".\"analytics\".\"fct_image_detections\"\nwhere message_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.483645Z", "completed_at": "2026-01-20T21:31:34.494331Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.503950Z", "completed_at": "2026-01-20T21:31:34.503950Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028693675994873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.relationships_fct_image_detections_channel_key__channel_key__ref_dim_channels_.202eac5a7c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select channel_key as from_field\n    from \"medical_warehouse\".\"analytics\".\"fct_image_detections\"\n    where channel_key is not null\n),\n\nparent as (\n    select channel_key as to_field\n    from \"medical_warehouse\".\"analytics\".\"dim_channels\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T21:31:34.497784Z", "completed_at": "2026-01-20T21:31:34.505711Z"}, {"name": "execute", "started_at": "2026-01-20T21:31:34.507309Z", "completed_at": "2026-01-20T21:31:34.507309Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014996051788330078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.relationships_fct_image_detections_date_key__date_key__ref_dim_dates_.5b9e4a4fa6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select date_key as from_field\n    from \"medical_warehouse\".\"analytics\".\"fct_image_detections\"\n    where date_key is not null\n),\n\nparent as (\n    select date_key as to_field\n    from \"medical_warehouse\".\"analytics\".\"dim_dates\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}], "elapsed_time": 0.5211899280548096, "args": {"show_resource_report": false, "warn_error_options": {"include": [], "exclude": []}, "print": true, "introspect": true, "profiles_dir": "C:\\Users\\yoga\\code\\10_Academy\\week_8\\medical_warehouse", "static": false, "send_anonymous_usage_stats": true, "static_parser": true, "empty_catalog": false, "quiet": false, "populate_cache": true, "partial_parse": true, "select": [], "version_check": true, "log_format": "default", "log_level": "info", "log_format_file": "debug", "write_json": true, "strict_mode": false, "use_colors_file": true, "favor_state": false, "compile": true, "indirect_selection": "eager", "enable_legacy_logger": false, "invocation_command": "dbt docs generate", "use_colors": true, "log_path": "C:\\Users\\yoga\\code\\10_Academy\\week_8\\medical_warehouse\\logs", "macro_debugging": false, "which": "generate", "partial_parse_file_diff": true, "vars": {}, "cache_selected_only": false, "printer_width": 80, "project_dir": "C:\\Users\\yoga\\code\\10_Academy\\week_8\\medical_warehouse", "defer": false, "log_level_file": "debug", "exclude": [], "log_file_max_bytes": 10485760}}